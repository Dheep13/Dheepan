Insert Into
    INBOUND_DATA_TXN (
        FILEDATE,
        FILENAME,
        ORDERID,
        LINENUMBER,
        SUBLINENUMBER,
        EVENTTYPEID,
        ACCOUNTINGDATE,
        PRODUCTID,
        PRODUCTNAME,
        PRODUCTDESCRIPTION,
        VALUE,
        UNITTYPEFORVALUE,
        NUMBEROFUNITS,
        UNITVALUE,
        UNITTYPEFORUNITVALUE,
        COMPENSATIONDATE,
        PAYMENTTERMS,
        PONUMBER,
        CHANNEL,
        ALTERNATEORDERNUMBER,
        DATASOURCE,
        NATIVECURRENCY,
        NATIVECURRENCYAMOUNT,
        DISCOUNTPERCENT,
        DISCOUNTTYPE,
        BILLTOCUSTID,
        BILLTOCONTACT,
        BILLTOCOMPANY,
        BILLTOAREACODE,
        BILLTOPHONE,
        BILLTOFAX,
        BILLTOADDRESS1,
        BILLTOADDRESS2,
        BILLTOADDRESS3,
        BILLTOCITY,
        BILLTOSTATE,
        BILLTOCOUNTRY,
        BILLTOPOSTALCODE,
        BILLTOINDUSTRY,
        BILLTOGEOGRAPHY,
        SHIPTOCUSTID,
        SHIPTOCONTACT,
        SHIPTOCOMPANY,
        SHIPTOAREACODE,
        SHIPTOPHONE,
        SHIPTOFAX,
        SHIPTOADDRESS1,
        SHIPTOADDRESS2,
        SHIPTOADDRESS3,
        SHIPTOCITY,
        SHIPTOSTATE,
        SHIPTOCOUNTRY,
        SHIPTOPOSTALCODE,
        SHIPTOINDUSTRY,
        SHIPTOGEOGRAPHY,
        OTHERTOCUSTID,
        OTHERTOCONTACT,
        OTHERTOCOMPANY,
        OTHERTOAREACODE,
        OTHERTOPHONE,
        OTHERTOFAX,
        OTHERTOADDRESS1,
        OTHERTOADDRESS2,
        OTHERTOADDRESS3,
        OTHERTOCITY,
        OTHERTOSTATE,
        OTHERTOCOUNTRY,
        OTHERTOPOSTALCODE,
        OTHERTOINDUSTRY,
        OTHERTOGEOGRAPHY,
        REASONID,
        COMMENTS,
        BUSINESSUNITNAME,
        GENERICATTRIBUTE1,
        GENERICATTRIBUTE2,
        GENERICATTRIBUTE3,
        GENERICATTRIBUTE4,
        GENERICATTRIBUTE5,
        GENERICATTRIBUTE6,
        GENERICATTRIBUTE7,
        GENERICATTRIBUTE8,
        GENERICATTRIBUTE9,
        GENERICATTRIBUTE10,
        GENERICATTRIBUTE11,
        GENERICATTRIBUTE12,
        GENERICATTRIBUTE13,
        GENERICATTRIBUTE14,
        GENERICATTRIBUTE15,
        GENERICATTRIBUTE16,
        GENERICATTRIBUTE17,
        GENERICATTRIBUTE18,
        GENERICATTRIBUTE19,
        GENERICATTRIBUTE20,
        GENERICATTRIBUTE21,
        GENERICATTRIBUTE22,
        GENERICATTRIBUTE23,
        GENERICATTRIBUTE24,
        GENERICATTRIBUTE25,
        GENERICATTRIBUTE26,
        GENERICATTRIBUTE27,
        GENERICATTRIBUTE28,
        GENERICATTRIBUTE29,
        GENERICATTRIBUTE30,
        GENERICATTRIBUTE31,
        GENERICATTRIBUTE32,
        GENERICNUMBER1,
        UNITTYPEFORGENERICNUMBER1,
        GENERICNUMBER2,
        UNITTYPEFORGENERICNUMBER2,
        GENERICNUMBER3,
        UNITTYPEFORGENERICNUMBER3,
        GENERICNUMBER4,
        UNITTYPEFORGENERICNUMBER4,
        GENERICNUMBER5,
        UNITTYPEFORGENERICNUMBER5,
        GENERICNUMBER6,
        UNITTYPEFORGENERICNUMBER6,
        GENERICDATE1,
        GENERICDATE2,
        GENERICDATE3,
        GENERICDATE4,
        GENERICDATE5,
        GENERICDATE6,
        GENERICBOOLEAN1,
        GENERICBOOLEAN2,
        GENERICBOOLEAN3,
        GENERICBOOLEAN4,
        GENERICBOOLEAN5,
        GENERICBOOLEAN6,
        RECORDSTATUS
    )
Select
    :1 as FILEDATE,
    :2 as FILENAME,
    'BB-' || IFNULL(FIELD33, '') || '-' || IFNULL(FIELD9, '') || '-' || IFNULL(FIELD21, '') as ORDERID,
CASE
        WHEN LENGTH(field13) = 19
        AND SUBSTRING(field13, 5, 1) = '-'
        AND SUBSTRING(field13, 8, 1) = '-'
        AND SUBSTRING(field13, 14, 1) = ':'
        AND SUBSTRING(field13, 17, 1) = ':' THEN IFNULL(
            TO_CHAR(
                TO_DATE(SUBSTRING(field13, 1, 10), 'YYYY-MM-DD'),
                'YYYYMMDD'
            ),
            '1'
        )
        ELSE field13
    END as LINENUMBER,
    to_number (IFNULL(FIELD35, '1')) as SUBLINENUMBER,
    'BroadBand Closed' as EVENTTYPEID,
    to_date (substr(FIELD11, 1, 10), 'YYYY-MM-DD') as ACCOUNTINGDATE,
    FIELD21 as PRODUCTID,
    NULL as PRODUCTNAME,
    FIELD22 as PRODUCTDESCRIPTION,
    to_number (FIELD40) as VALUE,
    'SGD' as UNITTYPEFORVALUE,
    '1' as NUMBEROFUNITS,
    ifnull(field39, '0') as UNITVALUE,
    'quantity' as UNITTYPEFORUNITVALUE,
    to_date (substr(FIELD14, 1, 10), 'YYYY-MM-DD') as COMPENSATIONDATE,
    NULL as PAYMENTTERMS,
    NULL as PONUMBER,
    NULL as CHANNEL,
    FIELD33 as ALTERNATEORDERNUMBER,
    'BCC' as DATASOURCE,
case
        when field42 is null then null
        else 'SGD'
    end as NATIVECURRENCY,
    to_number (FIELD42) as NATIVECURRENCYAMOUNT,
    replace(substr(field11, 1, 10), '-', '') as DISCOUNTPERCENT,
    NULL as DISCOUNTTYPE,
    FIELD15 as BILLTOCUSTID,
    FIELD19 as BILLTOCONTACT,
    FIELD16 as BILLTOCOMPANY,
    NULL as BILLTOAREACODE,
    NULL as BILLTOPHONE,
    NULL as BILLTOFAX,
    FIELD18 as BILLTOADDRESS1,
    FIELD17 as BILLTOADDRESS2,
    TO_CHAR(
        TO_dATE(FIELD14, 'YYYY-MM-DD HH24:MI:SS'),
        'YYYYMMDDHH24MIss'
    ) as BILLTOADDRESS3,
    FIELD36 as BILLTOCITY,
    FIELD35 as BILLTOSTATE,
    FIELD20 as BILLTOCOUNTRY,
    NULL as BILLTOPOSTALCODE,
    NULL as BILLTOINDUSTRY,
    NULL as BILLTOGEOGRAPHY,
    NULL as SHIPTOCUSTID,
    NULL as SHIPTOCONTACT,
    NULL as SHIPTOCOMPANY,
    NULL as SHIPTOAREACODE,
    NULL as SHIPTOPHONE,
    NULL as SHIPTOFAX,
    NULL as SHIPTOADDRESS1,
    NULL as SHIPTOADDRESS2,
    NULL as SHIPTOADDRESS3,
    NULL as SHIPTOCITY,
    NULL as SHIPTOSTATE,
    NULL as SHIPTOCOUNTRY,
    NULL as SHIPTOPOSTALCODE,
    NULL as SHIPTOINDUSTRY,
    NULL as SHIPTOGEOGRAPHY,
    NULL as OTHERTOCUSTID,
    NULL as OTHERTOCONTACT,
    NULL as OTHERTOCOMPANY,
    NULL as OTHERTOAREACODE,
    NULL as OTHERTOPHONE,
    NULL as OTHERTOFAX,
    NULL as OTHERTOADDRESS1,
    NULL as OTHERTOADDRESS2,
    NULL as OTHERTOADDRESS3,
    NULL as OTHERTOCITY,
    NULL as OTHERTOSTATE,
    NULL as OTHERTOCOUNTRY,
    NULL as OTHERTOPOSTALCODE,
    NULL as OTHERTOINDUSTRY,
    NULL as OTHERTOGEOGRAPHY,
    NULL as REASONID,
    NULL as COMMENTS,
    'ConSales_External' as BUSINESSUNITNAME,
    FIELD34 as GENERICATTRIBUTE1,
    FIELD32 as GENERICATTRIBUTE2,
    FIELD29 as GENERICATTRIBUTE3,
    FIELD30 as GENERICATTRIBUTE4,
    FIELD4 as GENERICATTRIBUTE5,
    FIELD9 as GENERICATTRIBUTE6,
    FIELD151 as GENERICATTRIBUTE7,
    FIELD37 as GENERICATTRIBUTE8,
    FIELD8 as GENERICATTRIBUTE9,
    FIELD3 as GENERICATTRIBUTE10,
    FIELD5 as GENERICATTRIBUTE11,
    FIELD10 as GENERICATTRIBUTE12,
    FIELD38 as GENERICATTRIBUTE13,
    FIELD39 as GENERICATTRIBUTE14,
    NULL as GENERICATTRIBUTE15,
    FIELD41 as GENERICATTRIBUTE16,
    FIELD2 as GENERICATTRIBUTE17,
    NULL as GENERICATTRIBUTE18,
    NULL as GENERICATTRIBUTE19,
    NULL as GENERICATTRIBUTE20,
    NULL as GENERICATTRIBUTE21,
    FIELD7 as GENERICATTRIBUTE22,
    NULL as GENERICATTRIBUTE23,
    NULL as GENERICATTRIBUTE24,
    FIELD43 as GENERICATTRIBUTE25,
    FIELD6 as GENERICATTRIBUTE26,
    FIELD36 as GENERICATTRIBUTE27,
    NULL as GENERICATTRIBUTE28,
    NULL as GENERICATTRIBUTE29,
    NULL as GENERICATTRIBUTE30,
    NULL as GENERICATTRIBUTE31,
    NULL as GENERICATTRIBUTE32,
    NULL as GENERICNUMBER1,
    NULL as UNITTYPEFORGENERICNUMBER1,
    NULL as GENERICNUMBER2,
    NULL as UNITTYPEFORGENERICNUMBER2,
    NULL as GENERICNUMBER3,
    NULL as UNITTYPEFORGENERICNUMBER3,
    NULL as GENERICNUMBER4,
    NULL as UNITTYPEFORGENERICNUMBER4,
    NULL as GENERICNUMBER5,
    NULL as UNITTYPEFORGENERICNUMBER5,
    NULL as GENERICNUMBER6,
    NULL as UNITTYPEFORGENERICNUMBER6,
    to_date (substr(FIELD12, 1, 10), 'YYYY-MM-DD') as GENERICDATE1,
    to_date (NULL, 'DD-MON-YYYY') as GENERICDATE2,
    to_date (NULL, 'DD-MON-YYYY') as GENERICDATE3,
    to_date (NULL, 'DD-MON-YYYY') as GENERICDATE4,
    to_date (NULL, 'DD-MON-YYYY') as GENERICDATE5,
    to_date (NULL, 'DD-MON-YYYY') as GENERICDATE6,
    NULL as GENERICBOOLEAN1,
    NULL as GENERICBOOLEAN2,
    NULL as GENERICBOOLEAN3,
    NULL as GENERICBOOLEAN4,
    NULL as GENERICBOOLEAN5,
    NULL as GENERICBOOLEAN6,
    '0' as RECORDSTATUS
from
    INBOUND_DATA_STAGING
Where
    1 = 1
    and 1 = 1
    and FILETYPE = 'BCCSCIIClosedBroadBandOrders'
    and FILENAME = '1756_BCCSCIIClosedBroadBandOrders_20240727065448.txt'
    and FILEDATE = '2024-09-01 03:05:36.7990000'
    and IFNULL(error_flag, 0) = 0