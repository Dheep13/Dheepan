
DROP TABLE EXT.CTAS_ARBALANCE_PRESTAGE;
CREATE COLUMN TABLE EXT.CTAS_ARBALANCE_PRESTAGE(
	STAGESALESTRANSACTIONSEQ BIGINT CS_FIXED NOT NULL GENERATED BY DEFAULT AS IDENTITY,
	ORDERID VARCHAR(255),
	LINENUMBER DECIMAL CS_DECIMAL_FLOAT,
	SUBLINENUMBER DECIMAL CS_DECIMAL_FLOAT,
	EVENTTYPEID VARCHAR(255),
	VALUE DECIMAL(25, 2) CS_FIXED,
	UNITTYPEFORVALUE VARCHAR(10),
	COMPENSATIONDATE DATE CS_DAYDATE,
	BUSINESSUNITNAME VARCHAR(50),
	PARTNERID VARCHAR(255),
	CUSTOMERID VARCHAR(255),
	CUSTOMERNAME VARCHAR(255),
	GENERICNUMBER1 DECIMAL(25, 2) CS_FIXED,
	UNITTYPEFOR30 VARCHAR(4),
	GENERICNUMBER2 DECIMAL(25, 2) CS_FIXED,
	UNITTYPEFOR60 VARCHAR(4),
	GENERICNUMBER3 DECIMAL(25, 2) CS_FIXED,
	UNITTYPEFOR90 VARCHAR(4),
	INBOUNDFILE VARCHAR(100),
	BATCHNAME VARCHAR(100)
)
UNLOAD PRIORITY 5 AUTO MERGE;


DROP table EXT.CTAS_ARBALANCE_IN;
create column table EXT.CTAS_ARBALANCE_IN
(
InvoiceNumber varchar(255),
ServiceOrderNumber nvarchar(255),
ServiceOrderDate varchar(255),
DueDate varchar(255),
CustomerId varchar(255),
BalanceValue varchar(255));

DROP TABLE EXT.CTAS_ARBALANCE_HISTORY;
CREATE COLUMN TABLE EXT.CTAS_ARBALANCE_HISTORY(
	BALANCESEQ BIGINT CS_FIXED NOT NULL GENERATED BY DEFAULT AS IDENTITY,
	LOADDATE LONGDATE CS_LONGDATE DEFAULT CURRENT_TIMESTAMP,
	INVOICENUMBER NVARCHAR(255),
	SERVICEORDERNUMBER NVARCHAR(255),
	SERVICEORDERDATE DATE CS_DAYDATE,
	DUEDATE DATE CS_DAYDATE,
	CUSTOMERID VARCHAR(255),
	BALANCEVALUE DECIMAL(25, 2) CS_FIXED,
	INBOUNDFILE NVARCHAR(255),
	PROCESSFLAG DECIMAL CS_DECIMAL_FLOAT
)
UNLOAD PRIORITY 5 AUTO MERGE;


drop table EXT.CTAS_ARBALANCE_HISTORY;
create column table EXT.CTAS_ARBALANCE_HISTORY
(Loaddate timestamp default current_timestamp  ,
INBOUNDFILE nvarchar(255),
PROCESSFLAG number);



insert into ext.CTAS_ARBALANCE_IN (
InvoiceNumber ,
ServiceOrderNumber ,
ServiceOrderDate,
DueDate ,
CustomerId ,
BalanceValue,
INBOUNDBATCH,
PROCESSFLAG)
(select 125,'R0008',current_date,add_days(current_date,92),'Customer', 10000.00, 'TEST_124',0 from dummy);
