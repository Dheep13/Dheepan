<MAPPING DESCRIPTION="" ISVALID="YES" NAME="m_OUT_GROUP_PREMIUM_DEDUCTION_EXTRACT" OBJECTVERSION="1" VERSIONNUMBER="1">
        <TRANSFORMATION DESCRIPTION="" NAME="SQ_CS_PARTICIPANT" OBJECTVERSION="1" REUSABLE="NO" TYPE="Source Qualifier" VERSIONNUMBER="1">
            <TRANSFORMFIELD DATATYPE="date/time" DEFAULTVALUE="" DESCRIPTION="" NAME="CDATE" PICTURETEXT="" PORTTYPE="INPUT/OUTPUT" PRECISION="29" SCALE="9" />
            <TRANSFORMFIELD DATATYPE="decimal" DEFAULTVALUE="" DESCRIPTION="" NAME="AMOUNT" PICTURETEXT="" PORTTYPE="INPUT/OUTPUT" PRECISION="25" SCALE="10" />
            <TRANSFORMFIELD DATATYPE="string" DEFAULTVALUE="" DESCRIPTION="" NAME="JV_NUMBER" PICTURETEXT="" PORTTYPE="INPUT/OUTPUT" PRECISION="255" SCALE="0" />
            <TRANSFORMFIELD DATATYPE="string" DEFAULTVALUE="" DESCRIPTION="" NAME="AGENT_CODE" PICTURETEXT="" PORTTYPE="INPUT/OUTPUT" PRECISION="255" SCALE="0" />
            <TRANSFORMFIELD DATATYPE="string" DEFAULTVALUE="" DESCRIPTION="" NAME="PLAN_NAME" PICTURETEXT="" PORTTYPE="INPUT/OUTPUT" PRECISION="255" SCALE="0" />
            <TRANSFORMFIELD DATATYPE="string" DEFAULTVALUE="" DESCRIPTION="" NAME="GL" PICTURETEXT="" PORTTYPE="INPUT/OUTPUT" PRECISION="255" SCALE="0" />
            <TABLEATTRIBUTE NAME="Sql Query" VALUE="with period as&#13;&#10;(&#13;&#10;select&#13;&#10;case when PER_START_DATE &lt; curr_month_1st_date&#13;&#10;  then PER_START_DATE&#13;&#10;    else PER_END_DATE&#13;&#10;      end as START_DATE_1,&#13;&#10;curr_month_1st_date - 1 as END_DATE_1,&#13;&#10;case when PER_START_DATE &lt; curr_month_1st_date&#13;&#10;  then curr_month_1st_date&#13;&#10;    else PER_START_DATE&#13;&#10;      end as START_DATE_2,&#13;&#10;PER_END_DATE as END_DATE_2&#13;&#10;from&#13;&#10;(&#13;&#10;select to_date(TXT_KEY_VALUE, 'yyyy-mm-dd') - 6 as PER_START_DATE,&#13;&#10;       to_date(TXT_KEY_VALUE, 'yyyy-mm-dd') as PER_END_DATE,&#13;&#10;       trunc(to_date(TXT_KEY_VALUE, 'yyyy-mm-dd'), 'mm') as curr_month_1st_date&#13;&#10;  from IN_ETL_CONTROL&#13;&#10; where txt_key_string = 'OPER_CYCLE_DATE'&#13;&#10;) t&#13;&#10;where rownum = 1&#13;&#10;)&#13;&#10;--select * from period&#13;&#10;SELECT A.COMPENSATIONDATE AS CDATE,&#13;&#10;       A.VALUE AS amount,&#13;&#10;       substr( A.PRODUCTID,instr( A.PRODUCTID,'_',3,2)+1, instr(substr( A.PRODUCTID,instr( A.PRODUCTID,'_',3,2)+1),'_',1,1)-1) as JV_NUMBER,&#13;&#10;       substr(A.PRODUCTID,instr(A.PRODUCTID,'_',-1,2)+1,8) as AGENT_CODE,&#13;&#10;       A.PRODUCTDESCRIPTION AS plan_name,&#13;&#10;       A.GENERICATTRIBUTE7 AS GL&#13;&#10;  FROM CS_SALESTRANSACTION A, period&#13;&#10; WHERE  1=1&#13;&#10; and A.TENANTID = 'AIAS'&#13;&#10;AND A.REASONSEQ = 17732923532773582&#13;&#10; and A.COMPENSATIONDATE BETWEEN period.START_DATE_1 and period.END_DATE_1&#13;&#10;     union all&#13;&#10; SELECT A.COMPENSATIONDATE AS CDATE,&#13;&#10;       A.VALUE AS amount,&#13;&#10;       substr( A.PRODUCTID,instr( A.PRODUCTID,'_',3,2)+1, instr(substr( A.PRODUCTID,instr( A.PRODUCTID,'_',3,2)+1),'_',1,1)-1) as JV_NUMBER,&#13;&#10;       substr(A.PRODUCTID,instr(A.PRODUCTID,'_',-1,2)+1,8) as AGENT_CODE,&#13;&#10;       A.PRODUCTDESCRIPTION AS plan_name,&#13;&#10;       A.GENERICATTRIBUTE7 AS GL&#13;&#10;  FROM CS_SALESTRANSACTION A, period&#13;&#10; WHERE  1=1&#13;&#10; and A.TENANTID = 'AIAS'&#13;&#10;AND A.REASONSEQ = 17732923532773582&#13;&#10; and A.COMPENSATIONDATE BETWEEN period.START_DATE_2 and period.END_DATE_2" />
            <TABLEATTRIBUTE NAME="User Defined Join" VALUE="" />
            <TABLEATTRIBUTE NAME="Source Filter" VALUE="" />
            <TABLEATTRIBUTE NAME="Number Of Sorted Ports" VALUE="0" />
            <TABLEATTRIBUTE NAME="Tracing Level" VALUE="Normal" />
            <TABLEATTRIBUTE NAME="Select Distinct" VALUE="NO" />
            <TABLEATTRIBUTE NAME="Is Partitionable" VALUE="NO" />
            <TABLEATTRIBUTE NAME="Pre SQL" VALUE="" />
            <TABLEATTRIBUTE NAME="Post SQL" VALUE="" />
            <TABLEATTRIBUTE NAME="Output is deterministic" VALUE="NO" />
            <TABLEATTRIBUTE NAME="Output is repeatable" VALUE="Never" />
        </TRANSFORMATION>
        <TRANSFORMATION DESCRIPTION="" NAME="exp_gen_filename" OBJECTVERSION="1" REUSABLE="NO" TYPE="Expression" VERSIONNUMBER="1">
            <TRANSFORMFIELD DATATYPE="date/time" DEFAULTVALUE="" DESCRIPTION="" EXPRESSION="CDATE" EXPRESSIONTYPE="GENERAL" NAME="CDATE" PICTURETEXT="" PORTTYPE="INPUT/OUTPUT" PRECISION="29" SCALE="9" />
            <TRANSFORMFIELD DATATYPE="decimal" DEFAULTVALUE="" DESCRIPTION="" EXPRESSION="AMOUNT" EXPRESSIONTYPE="GENERAL" NAME="AMOUNT" PICTURETEXT="" PORTTYPE="INPUT/OUTPUT" PRECISION="25" SCALE="10" />
            <TRANSFORMFIELD DATATYPE="string" DEFAULTVALUE="" DESCRIPTION="" EXPRESSION="JV_NUMBER" EXPRESSIONTYPE="GENERAL" NAME="JV_NUMBER" PICTURETEXT="" PORTTYPE="INPUT/OUTPUT" PRECISION="255" SCALE="0" />
            <TRANSFORMFIELD DATATYPE="string" DEFAULTVALUE="" DESCRIPTION="" EXPRESSION="AGENT_CODE" EXPRESSIONTYPE="GENERAL" NAME="AGENT_CODE" PICTURETEXT="" PORTTYPE="INPUT/OUTPUT" PRECISION="255" SCALE="0" />
            <TRANSFORMFIELD DATATYPE="string" DEFAULTVALUE="" DESCRIPTION="" EXPRESSION="PLAN_NAME" EXPRESSIONTYPE="GENERAL" NAME="PLAN_NAME" PICTURETEXT="" PORTTYPE="INPUT/OUTPUT" PRECISION="255" SCALE="0" />
            <TRANSFORMFIELD DATATYPE="string" DEFAULTVALUE="" DESCRIPTION="" EXPRESSION="GL" EXPRESSIONTYPE="GENERAL" NAME="GL" PICTURETEXT="" PORTTYPE="INPUT/OUTPUT" PRECISION="255" SCALE="0" />
            <TRANSFORMFIELD DATATYPE="string" DEFAULTVALUE="ERROR('transformation error')" DESCRIPTION="" EXPRESSION="'GROUP_PREMIUM_DEDUCTION_'||TO_CHAR(SESSSTARTTIME,'yyyymmdd')||'.TXT'&#13;&#10;" EXPRESSIONTYPE="GENERAL" NAME="FileName" PICTURETEXT="" PORTTYPE="OUTPUT" PRECISION="255" SCALE="0" />
            <TABLEATTRIBUTE NAME="Tracing Level" VALUE="Normal" />
        </TRANSFORMATION>
        <INSTANCE DESCRIPTION="" NAME="f_Group_Premium_Deduction" TRANSFORMATION_NAME="f_Group_Premium_Deduction" TRANSFORMATION_TYPE="Target Definition" TYPE="TARGET" />
        <INSTANCE DBDNAME="SGCALLIDUS" DESCRIPTION="" NAME="CS_PARTICIPANT" TRANSFORMATION_NAME="CS_PARTICIPANT" TRANSFORMATION_TYPE="Source Definition" TYPE="SOURCE" />
        <INSTANCE DESCRIPTION="" NAME="SQ_CS_PARTICIPANT" REUSABLE="NO" TRANSFORMATION_NAME="SQ_CS_PARTICIPANT" TRANSFORMATION_TYPE="Source Qualifier" TYPE="TRANSFORMATION">
            <ASSOCIATED_SOURCE_INSTANCE NAME="CS_PARTICIPANT" />
        </INSTANCE>
        <INSTANCE DESCRIPTION="" NAME="exp_gen_filename" REUSABLE="NO" TRANSFORMATION_NAME="exp_gen_filename" TRANSFORMATION_TYPE="Expression" TYPE="TRANSFORMATION" />
        <CONNECTOR FROMFIELD="CDATE" FROMINSTANCE="exp_gen_filename" FROMINSTANCETYPE="Expression" TOFIELD="DATE" TOINSTANCE="f_Group_Premium_Deduction" TOINSTANCETYPE="Target Definition" />
        <CONNECTOR FROMFIELD="AMOUNT" FROMINSTANCE="exp_gen_filename" FROMINSTANCETYPE="Expression" TOFIELD="AMOUNT" TOINSTANCE="f_Group_Premium_Deduction" TOINSTANCETYPE="Target Definition" />
        <CONNECTOR FROMFIELD="JV_NUMBER" FROMINSTANCE="exp_gen_filename" FROMINSTANCETYPE="Expression" TOFIELD="JV_NUMBER" TOINSTANCE="f_Group_Premium_Deduction" TOINSTANCETYPE="Target Definition" />
        <CONNECTOR FROMFIELD="AGENT_CODE" FROMINSTANCE="exp_gen_filename" FROMINSTANCETYPE="Expression" TOFIELD="AGENT_CODE" TOINSTANCE="f_Group_Premium_Deduction" TOINSTANCETYPE="Target Definition" />
        <CONNECTOR FROMFIELD="PLAN_NAME" FROMINSTANCE="exp_gen_filename" FROMINSTANCETYPE="Expression" TOFIELD="PLAN_NAME" TOINSTANCE="f_Group_Premium_Deduction" TOINSTANCETYPE="Target Definition" />
        <CONNECTOR FROMFIELD="GL" FROMINSTANCE="exp_gen_filename" FROMINSTANCETYPE="Expression" TOFIELD="GL" TOINSTANCE="f_Group_Premium_Deduction" TOINSTANCETYPE="Target Definition" />
        <CONNECTOR FROMFIELD="FileName" FROMINSTANCE="exp_gen_filename" FROMINSTANCETYPE="Expression" TOFIELD="FileName" TOINSTANCE="f_Group_Premium_Deduction" TOINSTANCETYPE="Target Definition" />
        <CONNECTOR FROMFIELD="GENERICATTRIBUTE3" FROMINSTANCE="CS_PARTICIPANT" FROMINSTANCETYPE="Source Definition" TOFIELD="GL" TOINSTANCE="SQ_CS_PARTICIPANT" TOINSTANCETYPE="Source Qualifier" />
        <CONNECTOR FROMFIELD="CREATEDATE" FROMINSTANCE="CS_PARTICIPANT" FROMINSTANCETYPE="Source Definition" TOFIELD="CDATE" TOINSTANCE="SQ_CS_PARTICIPANT" TOINSTANCETYPE="Source Qualifier" />
        <CONNECTOR FROMFIELD="SALARY" FROMINSTANCE="CS_PARTICIPANT" FROMINSTANCETYPE="Source Definition" TOFIELD="AMOUNT" TOINSTANCE="SQ_CS_PARTICIPANT" TOINSTANCETYPE="Source Qualifier" />
        <CONNECTOR FROMFIELD="USERID" FROMINSTANCE="CS_PARTICIPANT" FROMINSTANCETYPE="Source Definition" TOFIELD="JV_NUMBER" TOINSTANCE="SQ_CS_PARTICIPANT" TOINSTANCETYPE="Source Qualifier" />
        <CONNECTOR FROMFIELD="GENERICATTRIBUTE1" FROMINSTANCE="CS_PARTICIPANT" FROMINSTANCETYPE="Source Definition" TOFIELD="AGENT_CODE" TOINSTANCE="SQ_CS_PARTICIPANT" TOINSTANCETYPE="Source Qualifier" />
        <CONNECTOR FROMFIELD="GENERICATTRIBUTE2" FROMINSTANCE="CS_PARTICIPANT" FROMINSTANCETYPE="Source Definition" TOFIELD="PLAN_NAME" TOINSTANCE="SQ_CS_PARTICIPANT" TOINSTANCETYPE="Source Qualifier" />
        <CONNECTOR FROMFIELD="CDATE" FROMINSTANCE="SQ_CS_PARTICIPANT" FROMINSTANCETYPE="Source Qualifier" TOFIELD="CDATE" TOINSTANCE="exp_gen_filename" TOINSTANCETYPE="Expression" />
        <CONNECTOR FROMFIELD="AMOUNT" FROMINSTANCE="SQ_CS_PARTICIPANT" FROMINSTANCETYPE="Source Qualifier" TOFIELD="AMOUNT" TOINSTANCE="exp_gen_filename" TOINSTANCETYPE="Expression" />
        <CONNECTOR FROMFIELD="JV_NUMBER" FROMINSTANCE="SQ_CS_PARTICIPANT" FROMINSTANCETYPE="Source Qualifier" TOFIELD="JV_NUMBER" TOINSTANCE="exp_gen_filename" TOINSTANCETYPE="Expression" />
        <CONNECTOR FROMFIELD="AGENT_CODE" FROMINSTANCE="SQ_CS_PARTICIPANT" FROMINSTANCETYPE="Source Qualifier" TOFIELD="AGENT_CODE" TOINSTANCE="exp_gen_filename" TOINSTANCETYPE="Expression" />
        <CONNECTOR FROMFIELD="PLAN_NAME" FROMINSTANCE="SQ_CS_PARTICIPANT" FROMINSTANCETYPE="Source Qualifier" TOFIELD="PLAN_NAME" TOINSTANCE="exp_gen_filename" TOINSTANCETYPE="Expression" />
        <CONNECTOR FROMFIELD="GL" FROMINSTANCE="SQ_CS_PARTICIPANT" FROMINSTANCETYPE="Source Qualifier" TOFIELD="GL" TOINSTANCE="exp_gen_filename" TOINSTANCETYPE="Expression" />
        <TARGETLOADORDER ORDER="1" TARGETINSTANCE="f_Group_Premium_Deduction" />
        <ERPINFO />
    </MAPPING>
    