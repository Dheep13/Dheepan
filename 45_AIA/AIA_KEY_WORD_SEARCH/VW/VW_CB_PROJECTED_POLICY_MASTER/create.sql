CREATE VIEW "EXT"."VW_CB_PROJECTED_POLICY_MASTER" ( "BUNAME", "YEAR", "QUARTER", "WRI_DIST_CODE", "WRI_DIST_NAME", "WRI_DM_CODE", "WRI_DM_NAME", "WRI_AGY_CODE", "WRI_AGY_NAME", "WRI_AGY_LDR_CODE", "WRI_AGY_LDR_NAME", "WRI_AGT_CODE", "WRI_AGT_NAME", "FSC_TYPE", "RANK", "CLASS", "FSC_BSC_GRADE", "FSC_BSC_PERCENTAGE", "PONUMBER", "INSURED_NAME", "CONTRACT_CAT", "CONTRACT_CODE", "LIFE_NUMBER", "COVERAGE_NUMBER", "RIDER_NUMBER", "COMPONENT_CODE", "COMPONENT_NAME", "ISSUE_DATE", "INCEPTION_DATE", "RISK_COMMENCEMENT_DATE", "FHR_DATE", "BASE_RIDER_IND", "TRANSACTION_DATE", "PAYMENT_MODE", "POLICY_CURRENCY", "PROCESSING_PERIOD", "FOR_CALCULATE", "CREATED_DATE", "POLICYIDSEQ", "PAYMENT_METHOD", "PREMIUM_CES_DATE", "PREMIUM_TERM", "ANNUAL_PREM", "COMM_RATE", "TOTAL_COMM", "PROJECT_FYC", "PROJECT_RYC", "POLICY_SUBMISSION_DATE", "WRI_AGY_LDR_TITLE", "WRI_AGY_LDR_CLASSCODE", "WRI_AGY_SPINOFF_FLAG", "WRI_AGY_SPINOFF_START_DT", "WRI_AGY_ORASGMT_FLAG", "PRODUCT_NAME", "ACTUAL_FYC", "TTL_ACTUAL_FYC", "POLICY_STATUS", "OWNER_CLIENT_ID", "OWNER_CLIENT_TYPE", "SPILP_OR_TOPUP_FLG", "SP_RP_UL_FLG", "CB_KEY_MAN_FLG", "CB_DIRECT_MARKET_FLG", "CB_SYSTEM_EXCLUDE_FLG", "CB_USER_EXCLUDE_FLG", "PROJECTED_EXCLUDE_FLG", "CB_EXCLUDE_FLG", "CB_SPI_EXCLUDE_FLG" ) AS (SELECT 
    BUNAME,
    YEAR,
    QUARTER,
    WRI_DIST_CODE,
    WRI_DIST_NAME,
    WRI_DM_CODE,
    WRI_DM_NAME,
    WRI_AGY_CODE,
    WRI_AGY_NAME,
    WRI_AGY_LDR_CODE,
    WRI_AGY_LDR_NAME,
    WRI_AGT_CODE,
    WRI_AGT_NAME,
    FSC_TYPE,
    RANK,
    CLASS,
    FSC_BSC_GRADE,
    FSC_BSC_PERCENTAGE,
    PONUMBER,
    INSURED_NAME,
    CONTRACT_CAT,
    CONTRACT_CODE,
    LIFE_NUMBER,
    COVERAGE_NUMBER,
    RIDER_NUMBER,
    COMPONENT_CODE,
    COMPONENT_NAME,
    ISSUE_DATE,
    INCEPTION_DATE,
    RISK_COMMENCEMENT_DATE,
    FHR_DATE,
    BASE_RIDER_IND,
    TRANSACTION_DATE,
    PAYMENT_MODE,
    POLICY_CURRENCY,
    PROCESSING_PERIOD,
    FOR_CALCULATE,
    CREATED_DATE,
    POLICYIDSEQ,
    PAYMENT_METHOD,
    PREMIUM_CES_DATE,
    PREMIUM_TERM,
    ANNUAL_PREM,
    COMM_RATE,
    TOTAL_COMM,
    PROJECT_FYC,
    PROJECT_RYC,
    POLICY_SUBMISSION_DATE,
    WRI_AGY_LDR_TITLE,
    WRI_AGY_LDR_CLASSCODE,
    WRI_AGY_SPINOFF_FLAG,
    WRI_AGY_SPINOFF_START_DT,
    WRI_AGY_ORASGMT_FLAG,
    PRODUCT_NAME,
    ACTUAL_FYC,
    TTL_ACTUAL_FYC,
    POLICY_STATUS,
    OWNER_CLIENT_ID,
    OWNER_CLIENT_TYPE,
    SPILP_OR_TOPUP_FLG,
    SP_RP_UL_FLG,
    IFNULL(CB_KEY_MAN_FLG, 0) AS CB_KEY_MAN_FLG,
    IFNULL(CB_DIRECT_MARKET_FLG, 0) AS CB_DIRECT_MARKET_FLG,
    IFNULL(CB_SYSTEM_EXCLUDE_FLG, 0) AS CB_SYSTEM_EXCLUDE_FLG,
    IFNULL(CB_USER_EXCLUDE_FLG, 0) AS CB_USER_EXCLUDE_FLG,
    GREATEST(IFNULL(CB_KEY_MAN_FLG,0), IFNULL(CB_DIRECT_MARKET_FLG,0), IFNULL(CB_SYSTEM_EXCLUDE_FLG,0), IFNULL(CB_USER_EXCLUDE_FLG,0)) AS PROJECTED_EXCLUDE_FLG,
    GREATEST(IFNULL(CB_KEY_MAN_FLG,0), IFNULL(CB_DIRECT_MARKET_FLG,0), IFNULL(CB_USER_EXCLUDE_FLG,0)) AS CB_EXCLUDE_FLG,
    CB_SPI_EXCLUDE_FLG
FROM EXT.AIA_CB_PROJECTED_POLICY_MASTER)